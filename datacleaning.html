<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Generic - Hyperspace by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<a href="index.html" class="title">BSkidmore</a>
				<nav>
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="datacleaning.html" class="active">Data Cleaning</a></li>
						<li><a href="dataexploration.html">Data Exploration</a></li>						
					</ul>
				</nav>
			</header>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="main" class="wrapper">
						<div class="inner">


							<h1 class="major">Data Cleaning</h1>
							<h3>Create a Duplicate of the Data</h3>
							<p>Before starting to make any edits to the raw date, it is often important to make a copy of the data to ensure no data is accidentally destroyed when cleaning. If we make a mistake on the staging copy of the data, we can always recopy the original raw data.</p>
							<pre><code>
drop table if exists video.top_rated_movies_staging
;

create table video.top_rated_movies_staging
like video.top_rated_movies
;

insert video.top_rated_movies_staging
select *
from video.top_rated_movies
;
							</code></pre>


							<h3>Removing Duplicates</h3>
							<p>In order to clean raw data we need to remove any duplicate data. This can be achieved by assigning a row number to data and partitioning the data based on any criteria that would indicate duplicate data. In the interest of making the SQL code easy to read, I typically would use a CTE to partition the duplicates and then display only the duplicate data.</p>
							<pre><code>
with duplicate_cte as
(
select *,
row_number()Over(partition by title)as row_num
video.top_rated_movies_staging
)
delete * from duplicate_cte
where row_num > 1
;
							</code></pre>


							<h3>Standardize the Data</h3>
							<p>In order to make the data more readable and usable the next step is to standardize the data. This can include making adjustments such as changing "Incorporated" to "Inc.", so the same standard is used throughout the data. This can also include items such as extras spaces, ALL CAPS, and unnecessary punctuation.</p>
							<p>Here are a few bits of code that would accomplish several elements of standardizing the data.</p>
							<pre><code>
select discinct title
video.top_rated_movies_staging
order by title
;

select title, (trim(title))
video.top_rated_movies_staging
order by title
;

update video.top_rated_movies_staging
set title = trim(title)
;

select *
from video.top_rated_movies_staging
where genre like 'Sci%'
; 

update video.top_rated_movies_staging
set genre = 'Sci-fi'
where genre like '%Sci%'
;

select distinct format, trim(trailing '.' from format)
from video.top_rated_movies_staging
order by 1
;

select release_date
from video.top_rated_movies_staging
;

select release_date,
str_to_date(release_date, '%m/%d/%Y')
from video.top_rated_movies_staging
;

update video.top_rated_movies_staging
set release_date = str_to_date(release_date, '%m/%d/%Y')
;

alter table video.top_rated_movies_staging
modify column release_date date
; 
							</code></pre>


							<h3>Remove Null or Blank Values</h3>
							<p>text goes here</p>
							<pre><code>
select *
from video.top_rated_movies_staging
where total_laid_off is null
and percentage_laid_off is null
;

select *
from video.top_rated_movies_staging
where industry is null
or industry = ''
;

select t1.industry, t2.industry
from video.top_rated_movies_staging as t1
join video.top_rated_movies_staging as t2
	on t1.company = t2.company
    and t1.location = t2.location
where (t1.industry is null or t1.industry = '')
and t2.industry is not null
;


update video.top_rated_movies_staging as t1
join video.top_rated_movies_staging as t2
	on t1.company = t2.company
set t1.industry = t2.industry
where (t1.industry is null or t1.industry = '')
and t2.industry is not null
;

update world_layoffs.layoffs_staging2 
set industry = null
where industry = ''
;
								
							</code></pre>
							

						</code></pre>


						<h3>title goes here</h3>
						<p>text goes here</p>
						<pre><code>
code goes here
						</code></pre>							
							
						</section>
						</div>
					</section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>